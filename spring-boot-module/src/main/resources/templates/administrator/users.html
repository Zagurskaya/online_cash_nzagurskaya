<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:replace="fragments/menuadmin :: header-css"/>
</head>
<body>

<div th:replace="fragments/menuadmin :: header"/>

<div class="container">

    <H2>Users </H2>
    <form action="/admin/users/delete" th:object="${users}" method="post">

        <table class="table table-bordered table-hover table-striped">
            <thead>
            <tr>
                <th>Id</th>
                <th>Логин</th>
                <th>Пароль</th>
                <th>Фамилия</th>
                <th>Имя</th>
                <th>Отчество</th>
                <th>Role</th>
                <th>Delete</th>
                <th>New Password</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="user, stat : ${users}">
                <td th:text="${user.id}"></td>
                <td th:text="${user.username}"></td>
                <td th:text="${user.password}"></td>
                <td th:text="${user.lastName}"></td>
                <td th:text="${user.firstName}"></td>
                <td th:text="${user.patronymic}"></td>

                <td>
                    <form th:object="${Role}" method="post" action="/admin/users/update_role">
                        <th:block th:if="${user.id ==1}">
                            <option th:each="role,stat:${roles}"
                                    th:value="${role.id}"
                                    th:if="${user.id == role.id}"
                                    th:text="${role.name}">
                        </th:block>

                        <th:block th:if="${user.id !=1}">
                            <input hidden value="#" th:attr="value=${user.id}" th:name="id"/>
                            <select name="role" th:name="roleId" required>
                                <option th:each="role,stat:${roles}"
                                        th:value="${role.id}"
                                        th:text="${role.name}"
                                        th:selected="${user.roleId == role.id}">
                                </option>
                            </select>
                        </th:block>

                        <th:block th:if="${user.id !=1}">
                            &nbsp;
                            <button class="btn btn-light btn-xs">
                                <!--<button class="btn btn-light btn-xs" method="post" action="/admin/users/update_role">-->
                                Update
                            </button>
                        </th:block>
                    </form>
                </td>
                <td><input th:if="${user.id !=1}" type="checkbox" th:name="ids"
                           th:value="${user.id}" th:checked="${user.isNotActive}"/></td>
                <td>
                    <form th:object="${user}" method="post" action="/admin/users/update_password">
                        <input hidden value="#" th:attr="value=${user.id}" th:name="id"/>
                        <button class="btn btn-light btn-xs">Update Password </button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
        <div class="field">
            <button type="submit" value="submit" class="btn btn-success">Delete users</button>
        </div>
    </form>
</div>
<div th:replace="fragments/footer :: footer"/>

</body>
</html>